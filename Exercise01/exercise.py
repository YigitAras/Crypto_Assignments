#!/home/yigitaras/anaconda3/envs/arascryptoenv/bin/python3
# To install Crypto module: 
# pip install pycryptdome or pip3 install pycryptdome
from Crypto.Cipher import AES
from Crypto import Random
from Crypto.Util.Padding import unpad

import random

# OFB Example
key =  b'\xa0\xa7\xe6\xdd\xd9\xf2$\xdc\xfe\xc5.\xe7\xee\xb9\xdf_'
ctext =  b'}\xd0\xf9E\xad\x8c\x95h\xc0\xa6\xbc\xe7\xb3\xa1\x9d|\x15\rQ\x1993\xe4\xee q\xe3\x9b8\r|\xfc\xe0\xd8Q?\xc8\x8f\x80'
cipher = AES.new(key, AES.MODE_OFB, ctext[:16])
dtext = cipher.decrypt(ctext[16:])
print ("dtext: ", dtext)

# Find out the modes and deccrypt the following ciphertexts with given keys
print ("For the following ciphertexts")
print ("Find out the modes and deccrypt the following ciphertexts with given keys")
print ("Note that the first (8 or 16) bytes of the are either IV or counter")
print("\n")
key1 =  b'\xb5\x86\x0e\x9c\x17\xf7\xbd\xf9C\xc4z\x08B#\xe0\x1d'
ctext1 =  b'\x80\xf6z\x92\xbc\xe5\xfe\xd7\x97\xdb\xdd\x1f%\xd6 \xadH\x85\\,\x00\x90\xca\x05\xe5B\x95\xad-\xd3\x15l\x01e\xe1\x8b\xcc\xec\xa6\x9b\x93\x0eK\x19H~M\x10v\x14\xdf\x8a\xe8\x8am\x89'
cipher1 = AES.new(key1,AES.MODE_OFB, ctext1[:16])
dtext1 = cipher1.decrypt(ctext1[16:])
print("dtext1 : ", dtext1)
print("\n")
key2 =  b't\\\xb4N\x86\x92\x1d\x1f\xa0\xc0\x80\x96\x8f`\x96\xd1'
ctext2 =  b',w\xe2N\x16a\xb9\xf7\xeeJ\x01\xe74\x8bx\x9c\x9d\xf4q\x94\xe4\xb3\xec\x8854\x82\x8e\x98%:t\x97K\xdcjB\xd7\x9f\x880\xfei\x0b\xd5\xc7:\xc5\xaa\x1c$T\x86\x98\xff\xa2t)\xa9\n\xddXxMtc_\x18\xaeB\xf2Vw&8\xa0\xfeLpG0,\x1aR\x19\xc4<\xf3\x95N\x80&q\xfd\xd8\xad'
cipher2 = AES.new(key2,AES.MODE_CFB, ctext2[:16])
dtext2 = cipher2.decrypt(ctext2[16:])
print("dtext2 : ", dtext2)
print("\n")

key3 =  b'\xedl\x13\t\x13i\x93+\x80h\xb1u(\x0f\xfb\xbf'
ctext3 =  b'\x01\xacaC\xff+\xc3\x95\xb6\xbau\xa4\xff7\xcau\x1b\x10\r]\x93\xbba\xe4\xd7\xfb.)\xeb\xb6*\xf7\x0f1\xaf\xd0s^\xd0\x8a\xad\xa4\xf5\xfelBv`\xc4]P\x9a\xa0\xeb\xa4-\xb7'
cipher3 = AES.new(key3,AES.MODE_CTR,nonce=ctext3[:8])
dtext3 = cipher3.decrypt(ctext3[8:])
print("dtext3 : ", dtext3)
print("\n")

key4 =  b'\xd2|kV\xb7\r\x01\x14r\xe7\xfb\x92\x98\x0b\x08c'
ctext4 =  b's\xd9O\x91\x0e?&\x9e\xf98uva\xc4\xe3\xe7`\xcd\\\x13\xd4\x86\x99\xd3\xeb\x1dW\xff)\x12\x18Q\xd1v\x19\xdc@\xad\xdftw\x97\xea\xe5\xb4\x91I\xfc\x87\x14\xcf\xbc\xa1\xf4O\xfb\xc3v\x07m\xcb\x15Yd\xfb\x0e\x92\xbc\x94\x9f\x9b,y\x1f\xd6\xea,*\xe5\xc7\xbfFC\x86*\xc36\x95&\x1b\xb5R\xe8\xd4\xb9n'
cipher4 = AES.new(key4,AES.MODE_CBC, ctext4[:16])
dtext4 = cipher4.decrypt(ctext4[16:])
print("dtext4 : ", dtext4)
print("\n")